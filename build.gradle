plugins {
    id "java"
    id "application"
}


application {
    mainClassName = "by.radioegor146.classextractor.Main"
}

repositories {
    mavenLocal()
    mavenCentral()
    maven {
        url "http://repo.spring.io/plugins-release/"
    }
}

sourceCompatibility = "1.8"
targetCompatibility = "1.8"
[compileJava, compileTestJava]*.options*.encoding = "UTF-8"

version = "1.3.3.7"
archivesBaseName = "class-extractor"

configurations {
    bundle
    compile.extendsFrom bundle
}

jar {
    manifest {
        attributes "Main-Class": application.mainClassName
    }
    from {
        configurations.bundle.collect { it.isDirectory() ? it : zipTree(it) }
    }
}

dependencies {
    compile fileTree(dir: "libs-compile", includes: ["*.jar"])
    bundle fileTree(dir: "libs", includes: ["*.jar"])

    bundle group: 'org.ow2.asm', name: 'asm-commons', version: '7.3.1'
}

tasks.withType(JavaCompile) {
    options.fork = true
    options.forkOptions.executable = 'javac'
    options.compilerArgs << "-Xlint:deprecation" << "-Xlint:unchecked" << "-XDignore.symbol.file"
}

run {
    args "ows", "1.5.21.6.dll", "output.jar"
}